<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
        <meta charset="utf-8"/>
	    <title>main.c</title>
	    <link href="../../third-party/google-code-prettify/prettify-CppCoverage.css" type="text/css" rel="stylesheet" />
	    <script type="text/javascript" src="../../third-party/google-code-prettify/prettify.js"></script>
	</head>
    <body onload="prettyPrint()">
        <h4></h4>
        <pre class="prettyprint lang-cpp linenums">
#define _CRTDBG_MAP_ALLOC

#include "farmacie.h"
#include "repo.h"
#include "service.h"

#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;crtdbg.h&gt;

/*
Administratorul unei farmacii are nevoie de o aplicatie care permite gestiunea stocului din farmacie.
Fiecare medicament din stoc are un cod unic, un nume,concentratie, cantitate disponibila in stoc.
Creati o aplicatie care permite:
 a) Adaugare de noi medicamente. Daca medicamentul este deja in stoc trebuie actualizat cantitatea
 b) Actualizare medicamente (modificare nume, concentratie pentru un medicament din stoc)
 c) Stergerea intregului stoc dintr-un medicament dat
 d) Vizualizare medicamente din stoc, ordonat dupa nume, cantitate (crescator/descrescator)
 e) Vizualizare lista de medicamente filtrate dupa un criteriu. Medicamente unde stocul disponibil este
mai mic decat o valoare data; medicamente cu numele incepand cu o litera data.
*/

<span style = "background-color:#dfd">void testAll() {</span>
	
<span style = "background-color:#dfd">	test_createMedicament();
	test_adaugaCantitate();
	test_compCantitate();
	test_compNume();
	test_destroyMedicament();
	test_egalCod();
	test_egalMedicamente();
	test_egalModify();
	test_filterCantitate();
	test_filterNume();
	test_returnCod();
	test_stergeCantitate();
	test_valideazaMedicament();
	test_verifStoc();</span>
	
<span style = "background-color:#dfd">	test_createEmpty();
	test_destroy();
	test_extind();
	test_add();
	test_modify();
	test_deleteStoc();
	test_copyList();</span>

<span style = "background-color:#dfd">	test_addMedicament();
	test_modifyMedicament();
	test_deleteMedicament();
	test_getAllMedicamente();
	test_sort();
	test_copyListCantitate();
    test_copyListNume();</span>
	
<span style = "background-color:#dfd">}</span>

<span style = "background-color:#fdd">void printMedicament(Medicament* m) {
	printf("\033[1;33mCod\033[0m: %d  ", m-&gt;cod);
	printf("\033[1;33mNume\033[0m: %s  ", m-&gt;nume);
	printf("\033[1;33mConcentratie\033[0m: %d  ", m-&gt;concentratie);
	printf("\033[1;33mCantitate\033[0m: %d\n", m-&gt;cantitate);
}</span>

<span style = "background-color:#fdd">void clearInputBuffer() {</span>
	int c;
<span style = "background-color:#fdd">	while ((c = getchar()) != '\n' &amp;&amp; c != EOF) {</span>
		// scapam de input-ul nedorit
<span style = "background-color:#fdd">	}
}</span>

<span style = "background-color:#fdd">void readMedicament(Repo* lista) {</span>

<span style = "background-color:#fdd">	int cod = -1, cantitate = -1, concentratie = -1;
	char nume[31] = "";</span>

<span style = "background-color:#fdd">	printf("\033[1;36mIntroduceti medicamentul\033[0m:\n");
	printf("Cod: ");
	scanf_s("%d", &amp;cod);
	clearInputBuffer();</span>

<span style = "background-color:#fdd">	printf("Nume: ");
	scanf_s("%s", nume, 31);</span>

<span style = "background-color:#fdd">	printf("Concentratie: ");
	scanf_s("%d", &amp;concentratie);
	clearInputBuffer();</span>

<span style = "background-color:#fdd">	printf("Cantitate: ");
	scanf_s("%d", &amp;cantitate);
	clearInputBuffer();</span>

<span style = "background-color:#fdd">	int error = addMedicament(lista, cod, nume, concentratie, cantitate);
	if (error != 0) {
		printf("\033[1;31mMedicament invalid!\033[0m\n");
	}</span>
	else {
<span style = "background-color:#fdd">		printf("\033[1;32mMedicament adaugat!\033[0m\n");</span>
	}

<span style = "background-color:#fdd">}</span>

<span style = "background-color:#fdd">void modifyMedicamentDat(Repo* lista) {</span>

<span style = "background-color:#fdd">	int cod = -1, cantitate_noua = -1, concentratie_noua = -1;</span>
	char nume_nou[31];

<span style = "background-color:#fdd">	printf("\033[1;36mIntroduceti codul medicamentului\033[0m: ");
	scanf_s("%d", &amp;cod);
	clearInputBuffer();
	printf("\n");</span>

<span style = "background-color:#fdd">	printf("Numele nou: ");
	scanf_s("%s", nume_nou, 31);</span>

<span style = "background-color:#fdd">	printf("Concentratia noua: ");
	scanf_s("%d", &amp;concentratie_noua);
	clearInputBuffer();</span>

<span style = "background-color:#fdd">	int error = modifyMedicament(lista, cod, nume_nou, concentratie_noua);
	if (error != 0) {
		printf("\033[1;31mModificare neefectuata!\033[0m\n");
	}</span>
	else {
<span style = "background-color:#fdd">		printf("\033[1;32mMedicament modificat!\033[0m\n");</span>
	}
<span style = "background-color:#fdd">}</span>

<span style = "background-color:#fdd">void deleteMedicamentDat(Repo* lista) {
	int cod = -1;</span>

<span style = "background-color:#fdd">	printf("\033[1;36mIntroduceti codul medicamentului\033[0m: ");
	scanf_s("%d", &amp;cod);
	clearInputBuffer();</span>

<span style = "background-color:#fdd">	int error = deleteMedicament(lista, cod);
	if (error != 0) {
		printf("\033[1;31mStergere neefectuata!\033[0m\n");
	}</span>
	else {
<span style = "background-color:#fdd">		printf("\033[1;32mStergerea stocului efectuat!\033[0m\n");</span>
	}

<span style = "background-color:#fdd">}</span>

<span style = "background-color:#fdd">void sortMedicamente(Repo* lista) {
	int crescator = -1;</span>

<span style = "background-color:#fdd">	printf("\033[1;36mIntroduceti 1 pentru sortare crescatoare sau 0, altfel\033[0m: ");
	scanf_s("%d", &amp;crescator);
	clearInputBuffer();
	printf("\n");</span>

<span style = "background-color:#fdd">	if (crescator == 1 || crescator == 0) {
		Repo* copie = sort(lista, crescator, (sort_fct) compNume, (sort_fct) compCantitate);</span>

<span style = "background-color:#fdd">		printf("\033[1;32mMedicamentele sortate sunt:\033[0m\n");
		for (int i = 0; i &lt; copie-&gt;lungime; ++i) {
			if (verifStoc(copie-&gt;elemente[i])) {
				printMedicament(copie-&gt;elemente[i]);</span>
			}
<span style = "background-color:#fdd">		}
		printf("\n");
		destroy(copie);
	}</span>
	else {
<span style = "background-color:#fdd">		printf("\033[1;31mOptiune invalida!\033[0m\n");</span>
	}

<span style = "background-color:#fdd">}
void printAllMedicamente(Repo* lista) {</span>

<span style = "background-color:#fdd">	printf("\n\033[1;35mMedicamente\033[0m:\n");</span>

<span style = "background-color:#fdd">	for (int i = 0; i &lt; lista-&gt;lungime; ++i) {
		printMedicament(lista-&gt;elemente[i]);
	}
	printf("\n");
}</span>

<span style = "background-color:#fdd">void filterMedicamente(Repo* lista) {
	int cantitate = -1, optiune = -1;</span>
	char litera;

<span style = "background-color:#fdd">	printf("\033[1;36mIntroduceti 1 - filtrare dupa cantitate sau 0 - dupa nume\033[0m: ");
	scanf_s("%d", &amp;optiune);
	clearInputBuffer();
	printf("\n");</span>

<span style = "background-color:#fdd">	switch (optiune) {</span>
	case 1:
<span style = "background-color:#fdd">		printf("\033[1;36mIntroduceti cantitatea\033[0m: ");
		scanf_s("%d", &amp;cantitate);
		clearInputBuffer();</span>

<span style = "background-color:#fdd">		Repo* copie = copyListCantitate(lista, cantitate, (filter_fct_cantitate) filterCantitate);
		printAllMedicamente(copie);
		destroy(copie);</span>

<span style = "background-color:#fdd">		break;</span>
	case 0:
<span style = "background-color:#fdd">		printf("\033[1;36mIntroduceti prima litera\033[0m: ");
		scanf_s(" %c", &amp;litera, 1);</span>

<span style = "background-color:#fdd">	    copie = copyListNume(lista, litera, (filter_fct_nume) filterNume);
		printAllMedicamente(copie);
		destroy(copie);</span>

<span style = "background-color:#fdd">		break;</span>
	default:
<span style = "background-color:#fdd">		printf("\033[1;31mOptiune invalida!\033[0m\n");</span>

	}
	
<span style = "background-color:#fdd">}</span>

<span style = "background-color:#fdd">void run() {
	printf("\033[1;33mBun venit la farmacie!\033[0m\n");</span>

<span style = "background-color:#fdd">	Repo* allMedicamente = createEmpty((destroy_fct) destroyMedicament);
	int ruleaza = 1;</span>

<span style = "background-color:#fdd">	while (ruleaza) {
		printAllMedicamente(allMedicamente);</span>

<span style = "background-color:#fdd">		printf("\033[1;33m1.\033[0m Adauga medicament\n");
		printf("\033[1;33m2.\033[0m Modifica medicament\n");
		printf("\033[1;33m3.\033[0m Sterge stocul unui medicament\n");
		printf("\033[1;33m4.\033[0m Sorteaza medicamentele dupa nume si cantitate\n");
		printf("\033[1;33m5.\033[0m Filtreaza medicamentele dupa un anumit criteriu\n");
		printf("\033[1;33m0.\033[0m Exit\n\nComanda: ");</span>

<span style = "background-color:#fdd">		int comanda = -1;
		scanf_s("%d", &amp;comanda);
		clearInputBuffer();
		printf("\n");</span>

<span style = "background-color:#fdd">		switch (comanda) {</span>
		case 1:
<span style = "background-color:#fdd">			readMedicament(allMedicamente);
			break;</span>
		case 2:
<span style = "background-color:#fdd">			modifyMedicamentDat(allMedicamente);
			break;</span>
		case 3:
<span style = "background-color:#fdd">			deleteMedicamentDat(allMedicamente);
			break;</span>
		case 4:
<span style = "background-color:#fdd">			sortMedicamente(allMedicamente);
			break;</span>
		case 5:
<span style = "background-color:#fdd">			filterMedicamente(allMedicamente);
			break;</span>
		case 0:
<span style = "background-color:#fdd">			printf("\033[1;36mLa revedere!\033[0m\n");
			ruleaza = 0;
			break;</span>
		default:
<span style = "background-color:#fdd">			printf("\033[1;31mComanda invalida!!!\033[0m\n");</span>
		}
<span style = "background-color:#fdd">	}
	destroy(allMedicamente);
}</span>

<span style = "background-color:#dfd">int main() {
	_CrtSetDbgFlag(_CRTDBG_ALLOC_MEM_DF | _CRTDBG_LEAK_CHECK_DF);</span>

<span style = "background-color:#dfd">	testAll();</span>
	//run();

<span style = "background-color:#dfd">	_CrtDumpMemoryLeaks();
	return 0;</span>

<span style = "background-color:#dfd">}</span></pre>
        <hr />
        <table width="100%">
            <thead>
                <tr>
                    <th align="center">
                        <small>Generated by</small>
                        <a href="https://github.com/OpenCppCoverage/OpenCppCoverage/releases">
                            <strong>OpenCppCoverage (Version: 0.9.9.0)</strong>
                        </a>
                    </th>
                </tr>
            </thead>
        </table>
    </body>
</html>